<!DOCTYPE html>
<html lang="en">

<head>
  {% include layout/head.html %}
  {% include schema/schema-combined.js %}
  <meta property="og:title" content="{{ page.title }}" />
  <meta property="og:description" content="{{ page.description }}" />
  <meta property="og:image" content="{{ page.featured_image | absolute_url }}" />
  <meta property="og:url" content="{{ page.url | absolute_url }}" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Tillerstead LLC" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ page.title }}" />
  <meta name="twitter:description" content="{{ page.description }}" />
  <meta name="twitter:image" content="{{ page.featured_image | absolute_url }}" />
  <link rel="canonical" href="{{ page.url | absolute_url }}" />
  <title>{% if page.title %}{{ page.title }} | {% endif %}Tillerstead NJ HIC</title>
  {% if page.url == "/contact/" %}

  {% include forms/contact-page.html %}
  {% endif %}

  {% if page.permalink == "/success/" %}
  <script>
    (function () {
      const confettiRoot = document.getElementById("confetti");
      const partyBtn = document.getElementById("partyBtn");
      function burst(count) {
        if (!confettiRoot) return;
        confettiRoot.innerHTML = "";
        const reduce =
          window.matchMedia &&
          window.matchMedia("(prefers-reduced-motion: reduce)").matches;
        if (reduce) return;
        const colors = [
          "#0b6cff",
          "#10b981",
          "#f59e0b",
          "#ef4444",
          "#a855f7",
          "#14b8a6",
        ];
        for (let i = 0; i < count; i++) {
          const piece = document.createElement("i");
          const x = Math.floor(Math.random() * 100) + "vw";
          const dx = (Math.random() * 40 - 20).toFixed(1) + "vw";
          const r = Math.floor(Math.random() * 360) + "deg";
          const d = (Math.random() * 1.2 + 1.3).toFixed(2) + "s";
          piece.style.setProperty("--x", x);
          piece.style.setProperty("--dx", dx);
          piece.style.setProperty("--r", r);
          piece.style.setProperty("--d", d);
          piece.style.background =
            colors[Math.floor(Math.random() * colors.length)];
          if (Math.random() > 0.7) {
            piece.style.width = "12px";
            piece.style.height = "12px";
            piece.style.borderRadius = "999px";
          } else if (Math.random() > 0.7) {
            piece.style.height = "20px";
          }
          confettiRoot.appendChild(piece);
        }
        window.setTimeout(() => {
          confettiRoot.innerHTML = "";
        }, 3200);
      }
      window.setTimeout(() => burst(42), 180);
      if (partyBtn) partyBtn.addEventListener("click", () => burst(55));
    })();
  </script>
  {% endif %}
  </head>

<body class="ts-body">
  <!-- Skip Links for Accessibility - Multiple Targets -->
  <nav class="skip-links" aria-label="Skip navigation">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <a href="#footer-contact-heading" class="skip-link">Skip to contact</a>
  </nav>

  {% include layout/header.html %}

  {% include navigation/ts-breadcrumbs.html %}

  <main class="ts-main-content" role="main" id="main-content" aria-label="Main content">
    {{ content }}
  </main>

  {% include layout/footer.html %}

  <!-- Accessibility Toolbar (enable with ?a11y-tools in URL) -->
  {% include components/a11y-toolbar.html %}

  <!-- Service Worker Registration for Offline Support -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('[SW] Registered:', reg.scope))
          .catch(err => console.warn('[SW] Registration failed:', err));
      });
    }
  </script>
</body>

</html>