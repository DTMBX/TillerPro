<div class="quote-form-container">
  <!-- Header -->
  <header class="quote-form-header">
    <h1>
      <svg class="icon" width="24" height="24" fill="currentColor">
        <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
      </svg>
      Professional Quote Request
    </h1>
    <p class="subtitle">Get a detailed estimate with transparent pricing and legal protection</p>
    
    <div class="trust-badges">
      <span class="badge">
        <svg class="icon-sm" width="16" height="16" fill="currentColor"><path d="M9 12l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2m12-2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        TCNA Certified
      </span>
      <span class="badge">
        <svg class="icon-sm" width="16" height="16" fill="currentColor"><path d="M9 12l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2"/></svg>
        Licensed & Insured
      </span>
      <span class="badge">
        <svg class="icon-sm" width="16" height="16" fill="currentColor"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        30-Day Valid Quote
      </span>
    </div>
  </header>

  <!-- Validation Messages -->
  <div id="validation-messages" class="validation-messages" style="display: none;">
    <div id="validation-errors" class="validation-errors"></div>
    <div id="validation-warnings" class="validation-warnings"></div>
  </div>

  <!-- Main Form -->
  <form id="tillerpro-quote-form" class="quote-form">
    
    <!-- Section 1: Customer Information -->
    <section class="form-section">
      <h2 class="section-title">
        <span class="section-number">1</span>
        Your Information
      </h2>
      
      <div class="form-grid">
        <div class="form-field">
          <label for="customer-name">
            Full Name <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="customer-name" 
            name="customerName" 
            required
            autocomplete="name"
            placeholder="John Smith"
          >
        </div>
        
        <div class="form-field">
          <label for="customer-email">
            Email Address <span class="required">*</span>
          </label>
          <input 
            type="email" 
            id="customer-email" 
            name="customerEmail" 
            required
            autocomplete="email"
            placeholder="john@example.com"
          >
          <small class="field-hint">We'll send your quote to this email</small>
        </div>
        
        <div class="form-field">
          <label for="customer-phone">
            Phone Number <span class="required">*</span>
          </label>
          <input 
            type="tel" 
            id="customer-phone" 
            name="customerPhone" 
            required
            autocomplete="tel"
            placeholder="(609) 555-1234"
          >
        </div>
        
        <div class="form-field full-width">
          <label for="project-address">
            Project Address <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="project-address" 
            name="projectAddress" 
            required
            autocomplete="street-address"
            placeholder="123 Main St, Cherry Hill, NJ 08002"
          >
        </div>
      </div>
    </section>

    <!-- Section 2: Project Details -->
    <section class="form-section">
      <h2 class="section-title">
        <span class="section-number">2</span>
        Project Details
      </h2>
      
      <div class="form-grid">
        <div class="form-field full-width">
          <label for="project-name">
            Project Name
          </label>
          <input 
            type="text" 
            id="project-name" 
            name="projectName" 
            placeholder="e.g., Master Bathroom Remodel"
          >
        </div>
        
        <div class="form-field full-width">
          <label for="project-description">
            Project Description <span class="required">*</span>
          </label>
          <textarea 
            id="project-description" 
            name="projectDescription" 
            required
            rows="4"
            placeholder="Describe your project: rooms, tile preferences, timeline, special requirements..."
          ></textarea>
          <small class="field-hint">The more details you provide, the more accurate your quote will be</small>
        </div>
        
        <div class="form-field">
          <label for="project-complexity">
            Project Complexity
          </label>
          <select id="project-complexity" name="projectComplexity">
            <option value="easy">Simple (New construction, standard layout)</option>
            <option value="moderate" selected>Moderate (Some custom work)</option>
            <option value="complex">Complex (Difficult access, lots of cuts)</option>
            <option value="extreme">Extreme (Custom everything, structural issues)</option>
          </select>
        </div>
        
        <div class="form-field">
          <label for="project-timeline">
            Preferred Timeline
          </label>
          <select id="project-timeline" name="projectTimeline">
            <option value="asap">As soon as possible</option>
            <option value="1-2-weeks">1-2 weeks</option>
            <option value="2-4-weeks" selected>2-4 weeks</option>
            <option value="1-2-months">1-2 months</option>
            <option value="flexible">Flexible</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Section 3: Auto-Calculated Materials (Read-Only) -->
    <section class="form-section summary-section">
      <h2 class="section-title">
        <span class="section-number">3</span>
        Calculated Materials
      </h2>
      
      <div id="materials-summary" class="materials-summary">
        <div class="summary-item">
          <span class="summary-label">Total Area:</span>
          <span class="summary-value" id="summary-area">0 sq ft</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Tiles Needed:</span>
          <span class="summary-value" id="summary-tiles">0 pieces</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Grout Bags:</span>
          <span class="summary-value" id="summary-grout">0 bags</span>
        </div>
        <div class="summary-item">
          <span class="summary-label">Estimated Labor:</span>
          <span class="summary-value" id="summary-labor">0 hours</span>
        </div>
      </div>
      
      <p class="summary-note">
        <svg class="icon-sm" width="16" height="16" fill="currentColor">
          <path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Based on calculations from Tools Hub. Use the calculators to update these values.
      </p>
    </section>

    <!-- Section 4: Price Estimate Preview -->
    <section class="form-section estimate-section">
      <h2 class="section-title">
        <span class="section-number">4</span>
        Estimated Investment
      </h2>
      
      <div class="estimate-breakdown">
        <div class="estimate-row">
          <span>Materials</span>
          <span id="estimate-materials">$0.00</span>
        </div>
        <div class="estimate-row">
          <span>Labor</span>
          <span id="estimate-labor">$0.00</span>
        </div>
        <div class="estimate-row">
          <span>Sales Tax (6.625%)</span>
          <span id="estimate-tax">$0.00</span>
        </div>
        <div class="estimate-row total-row">
          <span>Estimated Total</span>
          <span id="estimate-total">$0.00</span>
        </div>
        <div class="estimate-row deposit-row">
          <span>Deposit Required (30%)</span>
          <span id="estimate-deposit">$0.00</span>
        </div>
      </div>
      
      <div class="estimate-note">
        <strong>Note:</strong> This is a preliminary estimate. Final quote will include detailed breakdown and may vary based on site conditions.
      </div>
    </section>

    <!-- Section 4.5: Financing Options (Optional) -->
    <section class="form-section financing-section" id="financing-section">
      <h2 class="section-title">
        <span class="section-number">ðŸ’³</span>
        Flexible Financing Options
      </h2>
      
      <p class="section-intro">
        Make your project more affordable with monthly payment plans. Select an option below to include financing in your quote.
      </p>
      
      <div class="financing-calculator-container" id="financing-calculator-container">
        <!-- Financing options will be loaded here via JavaScript -->
        <div class="financing-loading">
          <p>Calculating financing options...</p>
        </div>
      </div>
    </section>

    <!-- Section 5: Required Acknowledgments -->
    <section class="form-section acknowledgments-section">
      <h2 class="section-title">
        <span class="section-number">5</span>
        Required Acknowledgments
      </h2>
      
      <p class="acknowledgments-intro">
        Please review and check all boxes below. These acknowledgments protect both parties and ensure clear expectations.
      </p>
      
      <div id="acknowledgments-list" class="acknowledgments-list">
        <!-- Dynamically loaded from config -->
      </div>
    </section>

    <!-- Section 6: Additional Notes -->
    <section class="form-section">
      <h2 class="section-title">
        <span class="section-number">6</span>
        Additional Notes (Optional)
      </h2>
      
      <div class="form-field">
        <label for="additional-notes">
          Anything else we should know?
        </label>
        <textarea 
          id="additional-notes" 
          name="additionalNotes" 
          rows="3"
          placeholder="Special requirements, questions, concerns..."
        ></textarea>
      </div>
    </section>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" id="save-draft-btn">
        <svg class="icon-sm" width="16" height="16" fill="currentColor">
          <path d="M8 7V3m0 4L6 5m2 2l2-2m5 7H5a2 2 0 01-2-2V5a2 2 0 012-2h6l5 5v7a2 2 0 01-2 2z"/>
        </svg>
        Save Draft
      </button>
      
      <button type="submit" class="btn btn-primary" id="generate-quote-btn">
        <svg class="icon-sm" width="16" height="16" fill="currentColor">
          <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
        Generate Professional Quote (PDF)
      </button>
    </div>

    <!-- E-Signature Section (appears after quote generation) -->
    <div class="signature-section" id="signature-section" style="display: none;">
      <h3>Ready to Move Forward?</h3>
      <p>
        Sign your quote electronically for faster processing. We use industry-standard e-signature 
        technology (DocuSign) to protect your information and create a legally binding agreement.
      </p>

      <div class="provider-badge docusign">
        Secured by DocuSign
      </div>

      <div class="signature-actions">
        <button type="button" class="btn-sign-electronically" id="sign-now-btn">
          Sign Electronically
        </button>
        <button type="button" class="btn-sign-later" id="sign-later-btn">
          I'll Sign Later
        </button>
      </div>

      <!-- Signature Status (appears after signature request created) -->
      <div class="signature-status" id="signature-status" style="display: none;">
        <div class="status-header">
          <h4>Signature Status</h4>
          <span class="status-badge pending" id="overall-status">Awaiting Signatures</span>
        </div>

        <ul class="signers-list" id="signers-list">
          <!-- Dynamically populated -->
        </ul>

        <p style="font-size: 0.875rem; color: #64748b; margin-top: 1rem;">
          A signature link has been sent to all parties. You'll receive email notifications when signatures are completed.
        </p>
      </div>
    </div>
  </form>
</div>

<!-- E-Signature Modal (for embedded signing) -->
<div class="signature-modal" id="signature-modal">
  <div class="signature-modal-content">
    <div class="modal-header">
      <h2>Sign Your Quote</h2>
      <button type="button" class="modal-close" id="modal-close-btn" aria-label="Close">&times;</button>
    </div>
    <div class="modal-body">
      <div id="signature-embed-container">
        <!-- Embedded signature iframe loads here -->
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" id="modal-cancel-btn">Cancel</button>
    </div>
  </div>
</div>

<!-- Quote Form Script -->
<script>
(function() {
  'use strict';

  // Initialize when DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initQuoteForm);
  } else {
    initQuoteForm();
  }

  function initQuoteForm() {
    const form = document.getElementById('tillerpro-quote-form');
    if (!form) return;

    const generator = new QuoteGenerator();
    const config = window.TillerProConfig;
    
    // Load acknowledgments from config
    loadAcknowledgments();
    
    // Prefill from ProjectState
    prefillFromState();
    
    // Update estimates on input
    form.addEventListener('input', updateEstimates);
    
    // Handle form submission
    form.addEventListener('submit', handleSubmit);
    
    // Save draft button
    document.getElementById('save-draft-btn')?.addEventListener('click', saveDraft);
    
    /**
     * Load acknowledgment checkboxes from config
     */
    function loadAcknowledgments() {
      const container = document.getElementById('acknowledgments-list');
      if (!container || !config) return;
      
      const acknowledgments = config.quote.requiredAcknowledgments;
      
      container.innerHTML = acknowledgments.map(ack => `
        <label class="acknowledgment-item">
          <input 
            type="checkbox" 
            name="ack-${ack.id}" 
            id="ack-${ack.id}" 
            required
            data-ack-id="${ack.id}"
          >
          <span class="acknowledgment-label">${ack.label}</span>
        </label>
      `).join('');
    }
    
    /**
     * Prefill form from ProjectState
     */
    function prefillFromState() {
      const state = window.ProjectState;
      if (!state) return;
      
      const summary = state.getSummary();
      
      // Update materials summary
      document.getElementById('summary-area').textContent = `${summary.totalArea || 0} sq ft`;
      document.getElementById('summary-tiles').textContent = `${summary.tilesNeeded || 0} pieces`;
      document.getElementById('summary-grout').textContent = `${summary.groutBags || 0} bags`;
      
      const laborHours = summary.totalArea ? Math.ceil(summary.totalArea / 9) : 0;
      document.getElementById('summary-labor').textContent = `${laborHours} hours`;
      
      // Prefill project name if exists
      if (summary.projectName) {
        document.getElementById('project-name').value = summary.projectName;
      }
      
      updateEstimates();
    }
    
    /**
     * Update price estimates
     */
    function updateEstimates() {
      const state = window.ProjectState;
      if (!state) return;
      
      const summary = state.getSummary();
      const area = summary.totalArea || 0;
      
      // Rough estimates
      const materialsEstimate = area * 12; // $12/sqft for materials
      const laborEstimate = Math.ceil(area / 9) * 70; // 9 sqft/hr @ $70/hr
      const subtotal = materialsEstimate + laborEstimate;
      const tax = materialsEstimate * 0.06625; // Only materials taxed
      const total = subtotal + tax;
      const deposit = total * 0.30;
      
      document.getElementById('estimate-materials').textContent = `$${materialsEstimate.toFixed(2)}`;
      document.getElementById('estimate-labor').textContent = `$${laborEstimate.toFixed(2)}`;
      document.getElementById('estimate-tax').textContent = `$${tax.toFixed(2)}`;
      document.getElementById('estimate-total').textContent = `$${total.toFixed(2)}`;
      document.getElementById('estimate-deposit').textContent = `$${deposit.toFixed(2)}`;
      
      // Store total for financing calculator
      const totalEl = document.getElementById('estimate-total');
      if (totalEl) {
        totalEl.setAttribute('data-total-value', total.toFixed(2));
      }
      
      // Update financing options if total > 0
      if (total > 0 && window.financingCalc) {
        updateFinancingOptions(total);
      }
    }
    
    /**
     * Update financing options
     */
    function updateFinancingOptions(total) {
      const container = document.getElementById('financing-calculator-container');
      if (!container || !window.financingCalc) return;
      
      // Get selected credit tier or default to 'good'
      const creditTierSelect = document.getElementById('credit-tier-select');
      const creditTier = creditTierSelect ? creditTierSelect.value : 'good';
      
      window.financingCalc.renderFinancingOptions(total, container, creditTier);
    }
    
    /**
     * Handle form submission
     */
    async function handleSubmit(e) {
      e.preventDefault();
      
      // Clear previous messages
      hideValidationMessages();
      
      // Collect form data
      const formData = new FormData(form);
      const customerData = {
        name: formData.get('customerName'),
        email: formData.get('customerEmail'),
        phone: formData.get('customerPhone'),
        address: formData.get('projectAddress'),
        projectDescription: formData.get('projectDescription'),
        complexity: formData.get('projectComplexity'),
        notes: formData.get('additionalNotes')
      };
      
      // Collect acknowledgments
      const acknowledgments = {};
      config.quote.requiredAcknowledgments.forEach(ack => {
        acknowledgments[ack.id] = document.getElementById(`ack-${ack.id}`).checked;
      });
      
      // Build quote
      const quote = generator.buildQuote(customerData);
      quote.acknowledgments = acknowledgments;
      
      // Validate
      const validation = generator.validateQuote(quote);
      
      if (!validation.valid) {
        showValidationErrors(validation.errors);
        return;
      }
      
      if (validation.warnings.length > 0) {
        const proceed = await showValidationWarnings(validation.warnings);
        if (!proceed) return;
      }
      
      // Generate PDF
      try {
        showLoading();
        const pdf = await generator.generatePDF(quote);
        generator.downloadPDF(pdf, quote.quoteNumber);
        generator.saveQuote(quote);
        showSuccess(quote.quoteNumber);
      } catch (error) {
        showError('Failed to generate quote: ' + error.message);
      } finally {
        hideLoading();
      }
    }
    
    /**
     * Save draft to localStorage
     */
    function saveDraft() {
      const formData = new FormData(form);
      const draft = {};
      formData.forEach((value, key) => draft[key] = value);
      
      localStorage.setItem('tillerpro_quote_draft', JSON.stringify(draft));
      
      alert('Draft saved! You can return later to complete your quote.');
    }
    
    /**
     * Show validation errors
     */
    function showValidationErrors(errors) {
      const container = document.getElementById('validation-errors');
      container.innerHTML = `
        <div class="error-box">
          <h4>
            <svg class="icon-sm" width="16" height="16" fill="currentColor">
              <path d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            Please correct the following errors:
          </h4>
          <ul>
            ${errors.map(err => `<li>${err}</li>`).join('')}
          </ul>
        </div>
      `;
      
      document.getElementById('validation-messages').style.display = 'block';
      document.getElementById('validation-messages').scrollIntoView({ behavior: 'smooth' });
    }
    
    /**
     * Show validation warnings
     */
    function showValidationWarnings(warnings) {
      return new Promise((resolve) => {
        const container = document.getElementById('validation-warnings');
        container.innerHTML = `
          <div class="warning-box">
            <h4>
              <svg class="icon-sm" width="16" height="16" fill="currentColor">
                <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              Warnings (you can proceed):
            </h4>
            <ul>
              ${warnings.map(warn => `<li>${warn}</li>`).join('')}
            </ul>
            <button type="button" class="btn btn-secondary" onclick="this.closest('.validation-warnings').parentElement.style.display='none'; return false;">
              Cancel
            </button>
            <button type="button" class="btn btn-primary" onclick="document.getElementById('validation-messages').style.display='none';">
              Proceed Anyway
            </button>
          </div>
        `;
        
        document.getElementById('validation-messages').style.display = 'block';
        document.getElementById('validation-messages').scrollIntoView({ behavior: 'smooth' });
        
        // Note: This is simplified - in production, use proper event listeners
        resolve(confirm(warnings.join('\n\n') + '\n\nProceed anyway?'));
      });
    }
    
    /**
     * Hide validation messages
     */
    function hideValidationMessages() {
      document.getElementById('validation-messages').style.display = 'none';
      document.getElementById('validation-errors').innerHTML = '';
      document.getElementById('validation-warnings').innerHTML = '';
    }
    
    /**
     * Show loading state
     */
    function showLoading() {
      const btn = document.getElementById('generate-quote-btn');
      btn.disabled = true;
      btn.innerHTML = `
        <svg class="icon-sm animate-spin" width="16" height="16" fill="currentColor">
          <path d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"/>
        </svg>
        Generating PDF...
      `;
    }
    
    /**
     * Hide loading state
     */
    function hideLoading() {
      const btn = document.getElementById('generate-quote-btn');
      btn.disabled = false;
      btn.innerHTML = `
        <svg class="icon-sm" width="16" height="16" fill="currentColor">
          <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
        Generate Professional Quote (PDF)
      `;
    }
    
    /**
     * Show success message
     */
    function showSuccess(quoteNumber) {
      alert(`Success! Quote #${quoteNumber} has been generated and downloaded.\n\nCheck your email for a copy (if email system is configured).`);
      
      // Show e-signature section
      showSignatureSection(quoteNumber);
    }
    
    /**
     * Show error message
     */
    function showError(message) {
      alert('Error: ' + message);
    }

    /**
     * Show e-signature section after successful quote generation
     */
    function showSignatureSection(quoteNumber) {
      const section = document.getElementById('signature-section');
      if (!section) return;
      
      section.style.display = 'block';
      section.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      // Store current quote number for signature
      section.setAttribute('data-quote-number', quoteNumber);
      
      // Pulse the sign button to draw attention
      const signBtn = document.getElementById('sign-now-btn');
      signBtn.classList.add('pulse');
      setTimeout(() => signBtn.classList.remove('pulse'), 3000);
    }

    /**
     * Handle "Sign Now" button
     */
    async function handleSignNow() {
      const section = document.getElementById('signature-section');
      const quoteNumber = section.getAttribute('data-quote-number');
      
      if (!quoteNumber) {
        alert('Please generate a quote first.');
        return;
      }

      // Get the saved quote
      const quotes = JSON.parse(localStorage.getItem('tillerpro_quotes') || '[]');
      const quote = quotes.find(q => q.quoteNumber === quoteNumber);
      
      if (!quote) {
        alert('Quote not found. Please regenerate.');
        return;
      }

      // Get PDF blob (in real scenario, retrieve from storage or regenerate)
      const generator = window.QuoteGenerator;
      const pdf = await generator.generatePDF(quote);
      const pdfBlob = pdf.output('blob');

      try {
        // Create signature request
        const signatureManager = window.ESignatureManager;
        const result = await signatureManager.createSignatureRequest(quote, pdfBlob);

        // Show status UI
        showSignatureStatus(result);

        // If in test mode, show helpful message
        if (result.testMode) {
          alert('âœ… E-Signature request created in TEST MODE!\n\n' +
                `Request ID: ${result.requestId}\n` +
                `Status: ${result.status}\n\n` +
                'In production, customers would receive an email with DocuSign link.\n' +
                'Check browser console for details.');
        }
      } catch (error) {
        alert('Failed to create signature request: ' + error.message);
        console.error(error);
      }
    }

    /**
     * Show signature status UI
     */
    function showSignatureStatus(signatureRequest) {
      const statusDiv = document.getElementById('signature-status');
      const signersList = document.getElementById('signers-list');
      const overallStatus = document.getElementById('overall-status');

      // Populate signers
      signersList.innerHTML = signatureRequest.signers.map(signer => `
        <li class="signer-item">
          <div class="signer-info">
            <div class="signer-name">${signer.name}</div>
            <div class="signer-email">${signer.email}</div>
          </div>
          <div class="signer-status ${signer.status === 'signed' ? 'signed' : 'awaiting'}">
            ${signer.status === 'signed' ? 'Signed' : 'Awaiting Signature'}
          </div>
        </li>
      `).join('');

      // Update overall status
      overallStatus.textContent = signatureRequest.status === 'completed' ? 'Completed' : 'Awaiting Signatures';
      overallStatus.className = `status-badge ${signatureRequest.status.replace('_', '-')}`;

      statusDiv.style.display = 'block';
      
      // Hide action buttons
      document.querySelector('.signature-actions').style.display = 'none';
    }

    /**
     * Handle "Sign Later" button
     */
    function handleSignLater() {
      alert('No problem! You can sign your quote later.\n\nWe\'ll send you an email with a signature link that\'s valid for 30 days.');
      
      // Hide signature section
      document.getElementById('signature-section').style.display = 'none';
    }

    /**
     * Modal controls
     */
    function closeModal() {
      const modal = document.getElementById('signature-modal');
      modal.classList.remove('active');
    }

    // Event listeners for e-signature
    document.getElementById('sign-now-btn')?.addEventListener('click', handleSignNow);
    document.getElementById('sign-later-btn')?.addEventListener('click', handleSignLater);
    document.getElementById('modal-close-btn')?.addEventListener('click', closeModal);
    document.getElementById('modal-cancel-btn')?.addEventListener('click', closeModal);
    
    // Close modal on background click
    document.getElementById('signature-modal')?.addEventListener('click', (e) => {
      if (e.target.id === 'signature-modal') {
        closeModal();
      }
    });
  }
})();
</script>
